{
  "hash": "77a637e84d626a88b3ab3f149cd2d20d",
  "result": {
    "markdown": "---\ntitle: \"edibble experimental design with sensory discrimination tests\"\ndescription: |\n  Can Australians distinguish the true taste of Vegemite? Designing an experiment with sensory discrimination test using the `edibble` package. \nauthor:\n  - name: Emi Tanaka\n    url: https://emitanaka.org\n    affiliation: Monash University\n    affiliation_url: https://numbat.space/\ncategories: [R, experimental design, edibble]\ndate: 2022-07-30\nbibliography: ref.bib\n---\n\n\n\n\nThis blog post attempts to describe the experimental design in **@Williams2021-pa** for **sensory discrimination test on vegemite** using the `edibble` R package. Detailed descriptions are provided in @Williams2021-pa and I only provide an abridged version in this blog, except where quoted.\n\nFirst, I load the packages needed. The `edibble` package is currently only available on GitHub at https://github.com/emitanaka/edibble with plans to submit to [CRAN](https://cran.r-project.org/) in the next couple of months.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(edibble)\n```\n:::\n\n\n<br>  \n\nThere are **three types of sensory discrimination tests** that are used by sensory scientists Drs CiarÃ¡n Forde and Patrick Oâ€™Riordan in an experiment _**to see if a story about an alternative to vegemite could sharpen the taste buds and improve the discriminative abilities of Australian consumers**_. The three sensory discrimination tests are as described below in @Williams2021-pa:\n\n<blockquote>\n\ni. Triangle test. The consumer is presented with two samples of one product and one sample of the other and asked to pick the odd sample.\nii. Paired preference test. The consumer is presented with a sample of the standard product and the alternative and asked â€˜which sample do you prefer?â€™\niii. Monadic â€˜A not Aâ€™ test. Samples of the standard and alternative products are presented to the consumers in a sequential monadic order (one by one) and they are asked â€˜is this your normal product?â€™\n</blockquote>\n\nThese test are abbreviated as T, PP, and M, respectively. The experimental structure is briefly summarised below:\n\n* there are two versions of vegemite: normal (N) or spiked (S)\n* there are 168 consumers in total\n* half of the consumers tasted three pairs in the paired preference test and the other half tested two triplets in the triangle test\n* all consumers had six samples in the monadic test\n* experiment is conducted over 4 days\n* each consumer taste no more than 12 samples of vegemite \n* logistics allow only 42 consumers per day\n* cover story (or lack there of) is shown based on the day\n* the broad structure of the experiment is shown in Table \\@ref(tab:table1)\n\n\n\n::: {.cell}\n::: {.cell-output-display}\nTable: From @Williams2021-pa: broad structure of the vegemite experiment.\n\n|Day         |1    |2     |3      |4       |\n|:-----------|:----|:-----|:------|:-------|\n|Cover story |no   |no    |yes    |yes     |\n|Test        |T, M |PP, M |T, M   |PP, M   |\n|Consumer    |1-42 |43-84 |85-126 |127-168 |\n:::\n:::\n\n\nThe following is the experimental design description in @Williams2021-pa:\n\n<blockquote>\n\nWithin this structure a number of design features were introduced:\n\ni. Test order. On each day half of the consumers took the sequence of monadic tests first and the other half after either the paired preference or triangle tests.\nii. For the triangle test there are six possible triplets involving the two products (labelled N and S for normal and spiked vegemite respectively), namely: NNS, SNN, NSN, SSN, NSS and SNS. Two of these triplets were presented in sequence to each consumer and so an optimal rowâ€“column design was constructed for six treatments (triplets) in two rows (order of presentation) and 42 columns (consumers). The design generation package CycDesigN (http://www.vsni.co.uk/software/cycdesign/) was used to construct the layout. Furthermore the grouping option of the package was employed to ensure that each consumer sampled each product three times, that is, if the consumer received a triplet with two of the normal vegemite then the second triplet would contain two of the spiked vegemite. Separate randomisations of the design were used for 2 days.\niii. For the paired preference test the normal vegemite in a pair can be presented either first or second. Hence an optimal rowâ€“column design was constructed for two treatments (pair order) in three rows (order of presentation) and 42 columns (consumers). Separate randomisations of the design were used for 2 days.\niv. For the monadic test the six samples, three of each product (normal and spiked), were presented in a different sequential order to each consumer and so there was the chance to study the possibility of carryover effects from successive samples. CycDesigN was used to construct an optimal crossover design for two treatments (product type) in six periods (order of presentation) and 42 subjects (consumers). Separate randomisations of the design were used for 4 days.\n\n</blockquote>\n\n\n## Test order\n\n<blockquote>\n\nOn each day half of the consumers took the sequence of monadic tests first and the other half after either the paired preference or triangle tests.\n\n</blockquote>\n\nRecall:\n\n* experiment is conducted over 4 days\n* logistics allow only 42 consumers per day\n* cover story (or lack there of) is shown based on the day\n\n\nAt first I couldn't tell whether the cover story and the sensory tests (T and PP) were randomised or in systematic order, but in my communication with Emlyn Williams, he let me know it was randomised.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1)\ndes1 <- design(\"sensory evalution\") %>% \n  set_units(day = 4,\n            consumer = nested_in(day, 42)) %>% \n  set_trts(cover_story = c(\"yes\", \"no\"),\n           test = c(\"T,M\", \"PP,M\"),\n           test_first = c(\"T/PP\", \"M\")) %>% \n  allot_table(test:cover_story ~ day,\n                    test_first ~ consumer)\n\n\ndes1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# sensory evalution \n# An edibble: 168 x 5\n         day    consumer cover_story     test test_first\n   <unit(4)> <unit(168)>    <trt(2)> <trt(2)>   <trt(2)>\n 1      day1  consumer1          yes      T,M       T/PP\n 2      day1  consumer2          yes      T,M       M   \n 3      day1  consumer3          yes      T,M       T/PP\n 4      day1  consumer4          yes      T,M       T/PP\n 5      day1  consumer5          yes      T,M       T/PP\n 6      day1  consumer6          yes      T,M       M   \n 7      day1  consumer7          yes      T,M       T/PP\n 8      day1  consumer8          yes      T,M       M   \n 9      day1  consumer9          yes      T,M       M   \n10      day1  consumer10         yes      T,M       M   \n# â€¦ with 158 more rows\n```\n:::\n:::\n\n\nYou can check the allocation of the cover story and test by nesting it by day:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndes1 %>% \n  nest_by(day, cover_story, test)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 4 Ã— 4\n# Rowwise:  day, cover_story, test\n        day cover_story     test               data\n  <unit(4)>    <trt(2)> <trt(2)> <list<tibble[,2]>>\n1      day1         yes     T,M            [42 Ã— 2]\n2      day2         no      PP,M           [42 Ã— 2]\n3      day3         yes     PP,M           [42 Ã— 2]\n4      day4         no      T,M            [42 Ã— 2]\n```\n:::\n:::\n\n\n\n## Triangle test\n\n<blockquote>\nFor the triangle test there are six possible triplets involving the two products (labelled N and S for normal and spiked vegemite respectively), namely: NNS, SNN, NSN, SSN, NSS and SNS. Two of these triplets were presented in sequence to each consumer and so an optimal rowâ€“column design was constructed for six treatments (triplets) in two rows (order of presentation) and 42 columns (consumers)... if the consumer received a triplet with two of the normal vegemite then the second triplet would contain two of the spiked vegemite. Separate randomisations of the design were used for 2 days.\n</blockquote>\n\nRecall:\n\n* each consumer taste no more than 12 samples of vegemite \n* logistics allow only 42 consumers per day\n\nAs every consumer also does the monadic test which uses 6 samples, only 6 samples remain for the triangle test. The product lineups took me a while to figure it out -- the part that tripped me up was that the two lineups (out of NNS, SNN, NSN, SSN, NSS and SNS) that was presented to the consumer sequentially had to have the major product swapped, so you can't choose something like NNS and NSN because both lineups have the major product as N. This precludes from just two random selections from NNS, SNN, NSN, SSN, NSS and SNS, and requires a conditional randomisation.\n\nI decided to think of this as a two step process:\n\n1. choose the main product, and\n2. choose out of the sequences XXO, XOX and OXX where X denotes the major product.\n\nSince the product lineup is nested within the consumer, the major product allocation in `edibble` below automatically treats `consumer` as a block and in the assignment, it will try to ensure the major product is different in the two lineups for each consumer. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndes2 <- design(\"triangle test\") %>% \n    set_units(day = c(1, 4),\n              consumer = nested_in(day, 42),\n              product_lineup = nested_in(consumer, 2)) %>% \n    set_trts(major_product = c(\"spiked\", \"normal\"),\n             sequence = c(\"XXO\", \"XOX\", \"OXX\")) %>% \n    allot_table(major_product ~ product_lineup,\n                     sequence ~ product_lineup)\n\ndes2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# triangle test \n# An edibble: 168 x 5\n         day   consumer   product_lineup major_product sequence\n   <unit(2)> <unit(84)>      <unit(168)>      <trt(2)> <trt(3)>\n 1         1  consumer1 product_lineup1         normal      XOX\n 2         1  consumer1 product_lineup2         spiked      OXX\n 3         1  consumer2 product_lineup3         normal      XOX\n 4         1  consumer2 product_lineup4         spiked      OXX\n 5         1  consumer3 product_lineup5         normal      XXO\n 6         1  consumer3 product_lineup6         spiked      XOX\n 7         1  consumer4 product_lineup7         spiked      XXO\n 8         1  consumer4 product_lineup8         normal      XOX\n 9         1  consumer5 product_lineup9         normal      OXX\n10         1  consumer5 product_lineup10        spiked      XOX\n# â€¦ with 158 more rows\n```\n:::\n:::\n\n\nI could alternatively design the above as a row-column design.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndes2alt <- design(\"triangle test\") %>% \n    set_units(day = c(1, 4),\n              consumer = nested_in(day, 42),\n              order = 2,\n              product_lineup = crossed_by(consumer, order)) %>% \n    set_trts(major_product = c(\"spiked\", \"normal\"),\n             sequence = c(\"XXO\", \"XOX\", \"OXX\")) %>% \n    allot_table(major_product ~ product_lineup,\n                     sequence ~ product_lineup)\n\ndeggust::autoplot(des2alt)\n```\n\n::: {.cell-output-display}\n![](sensory-discrimination-tests_files/figure-html/des2alt-1.png){width=672}\n:::\n:::\n\n\n## Paired test \n\n<blockquote>\nFor the paired preference test the normal vegemite in a pair can be presented either first or second. Hence an optimal rowâ€“column design was constructed for two treatments (pair order) in three rows (order of presentation) and 42 columns (consumers). Separate randomisations of the design were used for 2 days.\n</blockquote>\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndes3 <- design(\"paired test\") %>% \n    set_units(day = c(2, 3),\n              consumer = nested_in(day, 42),\n              order = 3,\n              product_lineup = crossed_by(consumer, order)) %>% \n    set_trts(product_order = c(\"SN\", \"NS\")) %>% \n    allot_table(product_order ~ product_lineup)\n\ndeggust::autoplot(des3)\n```\n\n::: {.cell-output-display}\n![](sensory-discrimination-tests_files/figure-html/des3-1.png){width=672}\n:::\n:::\n\n\n\n## Monadic test\n\n<blockquote>\nFor the monadic test the six samples, three of each product (normal and spiked), were presented in a different sequential order to each consumer and so there was the chance to study the possibility of carryover effects from successive samples.\n</blockquote>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndes4 <- design(\"monadic test\") %>% \n    set_units(day = 4,\n              consumer = nested_in(day, 42),\n              order = 6,\n              product_lineup = crossed_by(consumer, order)) %>% \n    set_trts(product = c(\"spiked\", \"normal\")) %>% \n    allot_table(product ~ product_lineup)\n\noptions(deggust.nnode_max = Inf)\ndeggust::autoplot(des4)\n```\n\n::: {.cell-output-display}\n![](sensory-discrimination-tests_files/figure-html/des4-1.png){width=672}\n:::\n:::\n\n\n\n## Conclusion\n\nSo you might be wondering if Australians can indeed distinguish the true taste of vegemite? Well this blog post is not about the analysis but the experimental design. A short analysis is provided, however, in @Williams2021-pa ... and the answer is yes Australians knows their vegemite ðŸ˜‰\n\n## Acknowldegement\n\nI want to thank Emyln for being so prompt in answering my questions about this experiment and providing the data (which I didn't end up using in this blog post), that was mistakenly missing in the initial publication but [available now on the website](https://onlinelibrary.wiley.com/doi/10.1111/anzs.12364).\n",
    "supporting": [
      "sensory-discrimination-tests_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}